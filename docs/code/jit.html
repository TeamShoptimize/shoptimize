<!DOCTYPE html>  <html> <head>   <title>jit.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="anlegenPanel.html">                 anlegenPanel.coffee               </a>                                           <a class="source" href="benchmark.html">                 benchmark.coffee               </a>                                           <a class="source" href="benchmark_greedyparameter.html">                 benchmark_greedyparameter.coffee               </a>                                           <a class="source" href="configurationPanel.html">                 configurationPanel.coffee               </a>                                           <a class="source" href="controlPanel.html">                 controlPanel.coffee               </a>                                           <a class="source" href="demo.html">                 demo.coffee               </a>                                           <a class="source" href="demoPanel.html">                 demoPanel.coffee               </a>                                           <a class="source" href="flot.html">                 flot.coffee               </a>                                           <a class="source" href="floyd.html">                 floyd.coffee               </a>                                           <a class="source" href="gmaps.html">                 gmaps.coffee               </a>                                           <a class="source" href="greedyWorker.html">                 greedyWorker.coffee               </a>                                           <a class="source" href="importPanel.html">                 importPanel.coffee               </a>                                           <a class="source" href="init.html">                 init.coffee               </a>                                           <a class="source" href="jit.html">                 jit.coffee               </a>                                           <a class="source" href="parse.html">                 parse.coffee               </a>                                           <a class="source" href="routePanel.html">                 routePanel.coffee               </a>                                           <a class="source" href="startPanel.html">                 startPanel.coffee               </a>                                           <a class="source" href="util.html">                 util.coffee               </a>                                           <a class="source" href="viz.html">                 viz.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               jit.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">jit</span><span class="p">.</span><span class="nx">coffee</span> <span class="o">-</span> <span class="nx">Ansicht</span> <span class="nx">f</span><span class="err">Ã¼</span><span class="nx">r</span> <span class="nx">die</span> <span class="nx">Darstellung</span> <span class="nx">der</span> <span class="nx">berechneten</span> <span class="nx">Einkaufsrouten</span><span class="p">.</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Shoptimize = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Shoptimize</span>

<span class="nv">root = </span><span class="k">this</span>

<span class="nv">lineWidthModification = </span><span class="mi">15</span>
<span class="nv">highlightedAdjacency = </span><span class="p">[]</span>

<span class="nv">Shoptimize.JitGraph = </span><span class="o">-&gt;</span>

    <span class="nv">jitContainer = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div id=&#39;graphframe&#39;&gt;&lt;div id=&#39;infovis&#39;&gt;&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#vizCanvas&quot;</span><span class="p">))</span>

<span class="nv">Shoptimize.JitGraph.init = </span><span class="nf">(data) -&gt;</span>
    <span class="nx">initializeGraph</span> <span class="nx">data</span>
  
    <span class="nv">lineWidthModification = </span><span class="mi">15</span>

    <span class="nv">highlightedAdjacency = </span><span class="p">[]</span>


<span class="nv">initializeGraph = </span><span class="nf">(shopdata)  -&gt;</span>
    <span class="nv">json = </span><span class="p">[]</span>
    <span class="nv">numNodes = </span><span class="nx">shopdata</span><span class="p">.</span><span class="nx">shops</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span>

    <span class="nv">maxWeight = </span><span class="mi">0</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">numNodes</span><span class="p">]</span>
        <span class="k">for</span> <span class="nx">j</span> <span class="k">in</span> <span class="p">[</span><span class="nx">i</span><span class="p">..</span><span class="nx">numNodes</span><span class="p">]</span>
            <span class="nv">w = </span><span class="nx">shopdata</span><span class="p">.</span><span class="nx">distances</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="nx">w</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span> <span class="o">and</span> <span class="nx">w</span> <span class="o">isnt</span> <span class="kc">NaN</span> <span class="o">and</span> <span class="nx">w</span> <span class="o">isnt</span> <span class="kc">undefined</span>
                <span class="nv">maxWeight = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">maxWeight</span><span class="p">)</span>

        <span class="nv">weightFactor = </span><span class="mi">100</span> <span class="o">/</span> <span class="nx">maxWeight</span> <span class="err">/ 100</span>
        <span class="k">if</span> <span class="nx">weightFactor</span> <span class="o">is</span> <span class="kc">Infinity</span>
                <span class="nv">weightFactor = </span><span class="mi">1</span>

        <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">numNodes</span><span class="p">]</span>
            <span class="nv">id = </span><span class="nx">i</span>
            <span class="nv">name = </span><span class="nx">shopdata</span><span class="p">.</span><span class="nx">shops</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span>
            <span class="nv">adjacencies = </span><span class="p">[]</span>
            <span class="nv">articles = </span><span class="p">[]</span>
            <span class="nv">prices = </span><span class="p">[]</span>
            <span class="nv">availability = </span><span class="p">[]</span>
            <span class="nv">node =</span>
                    <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="nx">id</span>
                    <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="nx">name</span>
                    <span class="s2">&quot;adjacencies&quot;</span> <span class="o">:</span> <span class="nx">adjacencies</span>
                    <span class="s2">&quot;articles&quot;</span> <span class="o">:</span> <span class="nx">articles</span>
                    <span class="s2">&quot;prices&quot;</span> <span class="o">:</span> <span class="nx">prices</span>
                    <span class="s2">&quot;availability&quot;</span> <span class="o">:</span> <span class="nx">availability</span>
                        
                <span class="nx">json</span><span class="p">.</span><span class="nx">push</span> <span class="nx">node</span>

                <span class="k">for</span> <span class="nx">j</span> <span class="k">in</span> <span class="p">[</span><span class="nx">i</span><span class="p">..</span><span class="nx">numNodes</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Hinzufuegen von Kanten</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="k">if</span> <span class="nx">shopdata</span><span class="p">.</span><span class="nx">distances</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">and</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">j</span>
                        <span class="nv">edge = </span><span class="k">new</span> <span class="nb">Object</span>
                        <span class="nx">edge</span><span class="p">[</span><span class="s1">&#39;nodeTo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">j</span>
                        <span class="nx">edge</span><span class="p">[</span><span class="s1">&#39;nodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">i</span>
                        <span class="nv">data = </span><span class="k">new</span> <span class="nb">Object</span>
                        <span class="nx">data</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">shopdata</span><span class="p">.</span><span class="nx">distances</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span>
                        <span class="nv">lineCost = </span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nx">lineCost</span> <span class="o">is</span> <span class="mi">0</span>
                                <span class="nv">lineCost = </span><span class="mi">1</span>

                        <span class="nx">data</span><span class="p">[</span><span class="s1">&#39;lineWidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nx">weightFactor</span> <span class="o">*</span>
                                <span class="nx">MAX_LINE_WIDTH</span>
                        <span class="nx">edge</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">data</span>
                        <span class="nx">adjacencies</span><span class="p">.</span><span class="nx">push</span> <span class="nx">edge</span>
                </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Hinzufuegen der Preise und der Verfuegbarkeit</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">for</span> <span class="nx">j</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">shopdata</span><span class="p">.</span><span class="nx">prices</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="nx">articles</span><span class="p">.</span><span class="nx">push</span> <span class="nx">shopdata</span><span class="p">.</span><span class="nx">articles</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span>
                    <span class="nx">prices</span><span class="p">.</span><span class="nx">push</span> <span class="nx">shopdata</span><span class="p">.</span><span class="nx">prices</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>availability.push shopdata.availability[j][i]</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#infovis&#39;</span><span class="p">).</span><span class="nx">empty</span><span class="p">()</span>
        <span class="nx">init</span> <span class="nx">json</span>

<span class="nv">mapRouteToPathArray = </span><span class="nf">(route) -&gt;</span>
        <span class="nv">path = </span><span class="p">[]</span>
        <span class="k">for</span> <span class="nx">shop</span> <span class="k">in</span> <span class="nx">route</span>
                <span class="nx">path</span><span class="p">.</span><span class="nx">push</span> <span class="nx">shop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="nx">path</span>

<span class="nv">Shoptimize.JitGraph.highlightSolutionInGraph = </span><span class="nf">(floydWarshall, solution, color) -&gt;</span>

        <span class="nv">realPath = </span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nv">virtualPath = </span><span class="nx">mapRouteToPathArray</span> <span class="nx">solution</span><span class="p">.</span><span class="nx">best_route</span>

        <span class="k">for</span> <span class="nx">nextShop</span> <span class="k">in</span> <span class="nx">virtualPath</span>
                <span class="nv">path = </span><span class="nx">getPath</span><span class="p">(</span><span class="nx">floydWarshall</span><span class="p">,</span> <span class="nx">realPath</span><span class="p">[</span><span class="nx">realPath</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nx">nextShop</span><span class="p">)</span>
                <span class="nv">realPath = </span><span class="nx">realPath</span><span class="p">.</span><span class="nx">concat</span> <span class="nx">path</span>
                <span class="nx">realPath</span><span class="p">.</span><span class="nx">push</span> <span class="nx">nextShop</span>

        <span class="nv">path = </span><span class="nx">getPath</span><span class="p">(</span><span class="nx">floydWarshall</span><span class="p">,</span> <span class="nx">realPath</span><span class="p">[</span><span class="nx">realPath</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nv">realPath = </span><span class="nx">realPath</span><span class="p">.</span><span class="nx">concat</span> <span class="nx">path</span>
        <span class="nx">realPath</span><span class="p">.</span><span class="nx">push</span> <span class="mi">0</span>

        <span class="nx">highlightRoute</span><span class="p">(</span><span class="nx">realPath</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span>

        <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Highlights a whole route <code>path</code> in the graph from <code>nodeFrom</code>
to <code>nodeTo</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">highlightRoute = </span><span class="nf">(path, color) -&gt;</span>

        <span class="k">if</span> <span class="nx">highlightedAdjacency</span><span class="p">.</span><span class="nx">length</span> <span class="o">isnt</span> <span class="mi">0</span>
                <span class="nx">unhighlightAllEdges</span><span class="p">()</span>
 
        <span class="nv">currentNode = </span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="nx">nextNode</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">path</span> <span class="k">when</span> <span class="nx">i</span> <span class="o">isnt</span> <span class="mi">0</span>
                <span class="nx">JitGraph</span><span class="p">.</span><span class="nx">highlightEdge</span><span class="p">(</span><span class="nx">currentNode</span><span class="p">,</span> <span class="nx">nextNode</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span>
                <span class="nv">currentNode = </span><span class="nx">nextNode</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Highlights an edge in the graph by specifying
source node, target node and the color</p>

<p>In order to find the appropriate edge, all adjacencies of the source
node are searched for the the target node. The animation is implemented
by temporarily changing the edges line width and permanently changing
the color to the specified color.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Shoptimize.JitGraph.highlightEdge = </span><span class="nf">(nodeFrom, nodeTo, color) -&gt;</span>

        <span class="nv">graph = </span><span class="nb">window</span><span class="p">.</span><span class="nx">fd</span><span class="p">.</span><span class="nx">graph</span>
        <span class="nv">node = </span><span class="nx">graph</span><span class="p">.</span><span class="nx">getNode</span><span class="p">(</span><span class="nx">nodeFrom</span><span class="p">)</span>
        <span class="nv">adj = </span><span class="nx">graph</span><span class="p">.</span><span class="nx">getAdjacence</span><span class="p">(</span><span class="nx">nodeFrom</span><span class="p">,</span> <span class="nx">nodeTo</span><span class="p">)</span>

        <span class="nx">adj</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;toSmallerValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">if</span> <span class="nx">nodeFrom</span> <span class="o">&gt;</span> <span class="nx">nodeTo</span>
                <span class="nx">adj</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;toSmallerValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="k">if</span> <span class="nx">highlightedAdjacency</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">adj</span><span class="p">)</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span>
                <span class="nx">adj</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;doubleArrowEdge&#39;</span><span class="p">)</span>
        <span class="k">else</span>
                <span class="nx">adj</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;singleArrowEdge&#39;</span><span class="p">)</span>

        <span class="nx">highlightedAdjacency</span><span class="p">.</span><span class="nx">push</span> <span class="nx">adj</span>
        <span class="nv">lineWidth = </span><span class="nx">adj</span><span class="p">.</span><span class="nx">getData</span><span class="p">(</span><span class="s1">&#39;lineWidth&#39;</span><span class="p">)</span>
        <span class="nx">adj</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span>

        <span class="nx">fd</span><span class="p">.</span><span class="nx">plot</span><span class="p">()</span>

        <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>After selecting a new route all the edges should be unhighlighted.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Shoptimize.unhighlightAllEdges = </span><span class="o">-&gt;</span>

        <span class="k">while</span> <span class="nx">highlightedAdjacency</span><span class="p">.</span><span class="nx">length</span> <span class="o">isnt</span> <span class="mi">0</span>
                <span class="nv">adj = </span><span class="nx">highlightedAdjacency</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
                <span class="nx">adj</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="nx">GRAPH_EDGE_COLOR</span><span class="p">)</span>
                <span class="nx">adj</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;costs&#39;</span><span class="p">)</span>

        <span class="nx">fd</span><span class="p">.</span><span class="nx">plot</span><span class="p">()</span>

<span class="nv">iStuff = </span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/iPhone/i</span><span class="p">)</span> <span class="o">or</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/iPad/i</span><span class="p">)</span>
<span class="nv">nativeCanvasSupport = </span> <span class="k">typeof</span> <span class="nx">HTMLCanvasElement</span> <span class="o">is</span> <span class="s1">&#39;object&#39;</span> <span class="o">or</span>  <span class="k">typeof</span> <span class="nx">HTMLCanvasElement</span> <span class="o">is</span> <span class="s1">&#39;function&#39;</span>

<span class="nv">textSupport = </span><span class="nx">nativeCanvasSupport</span> <span class="o">and</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">).</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">).</span><span class="nx">fillText</span> <span class="o">is</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span>
<span class="nv">labelType = </span><span class="k">if</span> <span class="o">not</span> <span class="nx">nativeCanvasSupport</span> <span class="o">or</span> <span class="p">(</span><span class="nx">textSupport</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">iStuff</span><span class="p">)</span> <span class="k">then</span> <span class="s1">&#39;Native&#39;</span> <span class="k">else</span> <span class="s1">&#39;HTML&#39;</span>
<span class="nv">nativeTextSupport = </span><span class="nx">labelType</span> <span class="o">is</span> <span class="s1">&#39;Native&#39;</span>
<span class="nv">useGradients = </span><span class="nx">nativeCanvasSupport</span>
<span class="nv">animate = </span><span class="o">not</span> <span class="p">(</span><span class="nx">iStuff</span> <span class="o">or</span> <span class="o">not</span> <span class="nx">nativeCanvasSupport</span><span class="p">)</span>

<span class="nv">renderArrow = </span><span class="nf">(ctx, from, to, edge) -&gt;</span>
        <span class="nv">vect = </span><span class="k">new</span> <span class="nx">$jit</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">from</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">to</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">from</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">vect</span><span class="p">.</span><span class="nx">$scale</span><span class="p">(</span><span class="nx">edge</span><span class="p">[</span><span class="s1">&#39;Edge&#39;</span><span class="p">].</span><span class="nx">dim</span> <span class="err">/ vect.norm())</span>
        <span class="nv">intermediatePoint = </span><span class="k">new</span> <span class="nx">$jit</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">vect</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">to</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">vect</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nv">normal = </span><span class="k">new</span> <span class="nx">$jit</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="o">-</span><span class="nx">vect</span><span class="p">.</span><span class="nx">y</span> <span class="sr">/ 2, vect.x /</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nv">v1 = </span><span class="nx">intermediatePoint</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">normal</span><span class="p">)</span>
        <span class="nv">v2 = </span><span class="nx">intermediatePoint</span><span class="p">.</span><span class="nx">$add</span><span class="p">(</span><span class="nx">normal</span><span class="p">.</span><span class="nx">$scale</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">from</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">from</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">to</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">()</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">v1</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">v1</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">v2</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">v2</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">to</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">closePath</span><span class="p">()</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">fill</span><span class="p">()</span>

<span class="nv">renderEdgeCost = </span><span class="nf">(ctx, from, to, edge) -&gt;</span>

        <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">from</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">from</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">to</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>add the weights as labels to each edge</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">middle = </span><span class="k">new</span> <span class="nb">Object</span><span class="p">()</span>
        <span class="nx">middle</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">from</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="p">(</span><span class="nx">from</span><span class="p">.</span><span class="nx">x</span><span class="o">-</span><span class="nx">to</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span>
        <span class="nx">middle</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">from</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="p">(</span><span class="nx">from</span><span class="p">.</span><span class="nx">y</span><span class="o">-</span><span class="nx">to</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span>
        <span class="nv">ctx.font = </span><span class="s2">&quot;14pt Helvetica&quot;</span>
        <span class="nv">ctx.fillStyle = </span><span class="s2">&quot;#000000&quot;</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">edge</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">cost</span><span class="p">,</span> <span class="nx">middle</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="nx">middle</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="nv">Log =</span>
    <span class="nv">elem: </span><span class="kc">false</span>
    <span class="nv">write: </span><span class="nf">(text) -&gt;</span>
        <span class="k">if</span> <span class="o">not</span> <span class="nx">@elem</span>
            <span class="vi">@elem = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#log&quot;</span><span class="p">)</span>
            <span class="nx">@elem</span><span class="p">.</span><span class="nx">css</span>
                <span class="nv">position : </span><span class="s1">&#39;absolute&#39;</span>
                <span class="nv">left : </span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span>
                <span class="nv">top : </span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span>
            <span class="nx">@elem</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span>
        <span class="nx">@elem</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span>
    <span class="nv">close: </span><span class="o">-&gt;</span>
        <span class="k">if</span> <span class="nx">@elem</span>
            <span class="nx">@elem</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>

<span class="nv">init = </span><span class="nf">(json) -&gt;</span>
    <span class="nx">$jit</span><span class="p">.</span><span class="nx">ForceDirected</span><span class="p">.</span><span class="nx">Plot</span><span class="p">.</span><span class="nx">EdgeTypes</span><span class="p">.</span><span class="nx">implement</span>

        <span class="s1">&#39;singleArrowEdge&#39;</span> <span class="o">:</span>
                <span class="s1">&#39;render&#39;</span> <span class="o">:</span> <span class="nf">(edge, canvas) -&gt;</span>

                        <span class="nv">from = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">nodeFrom</span><span class="p">.</span><span class="nx">pos</span>
                        <span class="nv">to = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">nodeTo</span><span class="p">.</span><span class="nx">pos</span>
                        <span class="nv">ctx = </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getCtx</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>invert edge direction</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nv">swap = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">toSmallerValue</span>
                        <span class="k">if</span> <span class="nx">swap</span>
                                <span class="nv">tmp = </span><span class="nx">from</span>
                                <span class="nv">from = </span><span class="nx">to</span>
                                <span class="nv">to = </span><span class="nx">tmp</span>

                        <span class="nx">renderArrow</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">edge</span><span class="p">)</span>
                        <span class="nx">renderEdgeCost</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">edge</span><span class="p">)</span>

        <span class="s1">&#39;doubleArrowEdge&#39;</span> <span class="o">:</span>
                <span class="s1">&#39;render&#39;</span> <span class="o">:</span> <span class="nf">(edge, canvas) -&gt;</span>

                        <span class="nv">from = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">nodeFrom</span><span class="p">.</span><span class="nx">pos</span>
                        <span class="nv">to = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">nodeTo</span><span class="p">.</span><span class="nx">pos</span>
                        <span class="nv">ctx = </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getCtx</span><span class="p">()</span>

                        <span class="nx">renderArrow</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">edge</span><span class="p">)</span>
                        <span class="nx">renderArrow</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">edge</span><span class="p">)</span>
                        <span class="nx">renderEdgeCost</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">edge</span><span class="p">)</span>

        <span class="s1">&#39;costs&#39;</span><span class="o">:</span>
            <span class="s1">&#39;render&#39;</span><span class="o">:</span> <span class="nf">(edge, canvas) -&gt;</span>
                    <span class="nv">from = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">nodeFrom</span><span class="p">.</span><span class="nx">pos</span>
                    <span class="nv">to = </span><span class="nx">edge</span><span class="p">.</span><span class="nx">nodeTo</span><span class="p">.</span><span class="nx">pos</span>
                    <span class="nv">ctx = </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getCtx</span><span class="p">()</span>
                    <span class="nx">renderEdgeCost</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">edge</span><span class="p">)</span>

                
    <span class="nb">window</span><span class="p">.</span><span class="nv">fd = </span><span class="k">new</span> <span class="nx">$jit</span><span class="p">.</span><span class="nx">ForceDirected</span>
        <span class="nv">injectInto: </span><span class="s1">&#39;infovis&#39;</span>
        <span class="nv">animate: </span><span class="kc">true</span>
        <span class="nv">Navigation:</span>
            <span class="nv">enable: </span><span class="kc">true</span>
            <span class="nv">panning: </span><span class="s1">&#39;avoid nodes&#39;</span>
            <span class="nv">zooming: </span><span class="mi">10</span>
        <span class="nv">Node:</span>
            <span class="nv">overridable: </span><span class="kc">true</span>
            <span class="nv">dim: </span><span class="mi">10</span>
            <span class="nv">color: </span><span class="nx">GRAPH_NODE_COLOR</span>
            <span class="nv">type: </span><span class="s1">&#39;circle&#39;</span>
        <span class="nv">Edge:</span>
            <span class="nv">type: </span><span class="s1">&#39;costs&#39;</span>
            <span class="nv">overridable: </span><span class="kc">true</span>
            <span class="nv">color: </span><span class="nx">GRAPH_EDGE_COLOR</span>
            <span class="nv">lineWidth: </span><span class="mf">1.0</span>
            <span class="nv">dim: </span><span class="mi">25</span>
        <span class="nv">Label:</span>
            <span class="nv">size: </span><span class="mi">14</span>
            <span class="nv">style: </span><span class="s1">&#39;bold&#39;</span>
            <span class="nv">color: </span><span class="s1">&#39;#000&#39;</span>
        <span class="nv">Tips:</span>
            <span class="nv">enable: </span><span class="kc">false</span>

        <span class="nv">Events:</span>
            <span class="nv">enable: </span><span class="kc">true</span>
            <span class="nv">onMouseEnter: </span><span class="o">-&gt;</span>
                <span class="nx">fd</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getElement</span><span class="p">().</span><span class="nv">style.cursor = </span><span class="s1">&#39;move&#39;</span>
                <span class="k">return</span>
            <span class="nv">onMouseLeave: </span><span class="o">-&gt;</span>
                <span class="nx">fd</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getElement</span><span class="p">().</span><span class="nv">style.cursor = </span><span class="s1">&#39;&#39;</span>
                <span class="k">return</span>
            <span class="nv">onDragMove: </span><span class="nf">(node, eventInfo, e) -&gt;</span>
                <span class="nv">pos = </span><span class="nx">eventInfo</span><span class="p">.</span><span class="nx">getPos</span><span class="p">()</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">pos</span><span class="p">.</span><span class="nx">setc</span> <span class="nx">pos</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">pos</span><span class="p">.</span><span class="nx">y</span>
                <span class="nx">fd</span><span class="p">.</span><span class="nx">plot</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="nv">onTouchMove: </span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">eventInfo</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">$jit</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">stop</span> <span class="nx">e</span>
                <span class="nx">@onDragMove</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">eventInfo</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="nv">onClick: </span><span class="nf">(node, eventInfo, e) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>dev - return immediately</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">return</span>

                <span class="k">if</span> <span class="o">not</span> <span class="nx">node</span>
                    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#inner-details&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="nv">html = </span><span class="s2">&quot;&lt;h2&gt;&lt;label&gt;&quot;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">name</span>
                <span class="nv">preishtml = </span><span class="s2">&quot;&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>0 is HOME</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="nx">html</span> <span class="o">+=</span> <span class="s2">&quot;&amp;nbsp; - &amp;nbsp;Preise &amp;nbsp;&quot;</span>
                    <span class="nx">preishtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;table border=&#39;0&#39; cellpadding=&#39;0&#39; width=&#39;100%&#39;&gt;&quot;</span>
                    <span class="nv">preisCol = </span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">thisjson</span><span class="p">.</span><span class="nx">articles</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="nv">article = </span><span class="nx">thisjson</span><span class="p">.</span><span class="nx">articles</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
                        <span class="nv">pricehere = </span><span class="nx">thisjson</span><span class="p">.</span><span class="nx">prices</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">preisCol</span><span class="p">]</span>
                        <span class="nv">availhere = </span><span class="nx">thisjson</span><span class="p">.</span><span class="nx">availability</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">preisCol</span><span class="p">]</span>
                        <span class="nx">preishtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="o">+</span><span class="nx">article</span><span class="o">+</span><span class="s2">&quot;&lt;/td&gt;&quot;</span>
                        <span class="k">if</span> <span class="nx">availhere</span>
                            <span class="nv">iconClass = </span><span class="s2">&quot;ui-icon-closethick&quot;</span>
                            <span class="nv">styleclass = </span><span class="s2">&quot;&quot;</span>
                        <span class="k">else</span>
                            <span class="nv">styleclass = </span><span class="s2">&quot;ui-state-disabled&quot;</span>
                            <span class="nv">iconClass = </span><span class="s2">&quot;ui-icon-check&quot;</span>
                        <span class="nx">preishtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;td&gt;&lt;input type=&#39;text&#39; class=#{styleclass} size=&#39;4&#39; onkeyup=&#39;editPrice(&quot;</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="nx">preisCol</span><span class="o">+</span><span class="s2">&quot;,this)&#39; value=&#39;&quot;</span><span class="o">+</span><span class="nx">pricehere</span><span class="o">+</span><span class="s2">&quot;&#39;/&gt;&lt;/td&gt;&quot;</span>
                        <span class="nx">preishtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;td class=#{styleclass}&gt;&lt;span class=&#39;ui-icon #{iconClass}&#39; style=&#39;float:right;&#39; onClick=&#39;editAvailability(#{i},#{preisCol},#{pricehere},this)&#39;&gt;  &lt;/span&gt;&lt;/td&gt;&quot;</span>
                        <span class="nx">preishtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span>
                <span class="nx">html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/label&gt;&lt;/h2&gt;&quot;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#inner-details&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="s1">&#39;.portlet-header&#39;</span> <span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span>
                <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#inner-details&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="s1">&#39;.portlet-content&#39;</span> <span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">preishtml</span><span class="p">)</span>
                <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#inner-details&#39;</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">pageY</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">pageX</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">show</span><span class="p">()</span>
                <span class="k">return</span>
        <span class="nv">iterations: </span><span class="mi">50</span>
        <span class="nv">levelDistance: </span><span class="mi">220</span>
        <span class="nv">onCreateLabel: </span><span class="nf">(domElement, node) -&gt;</span>
            <span class="nv">domElement.innerHTML = </span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">eachAdjacency</span> <span class="nf">(adj) -&gt;</span>
                    <span class="nx">adj</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;lineWidth&#39;</span><span class="p">,</span> <span class="nx">adj</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">lineWidth</span><span class="p">)</span>

            <span class="k">return</span>
            
        <span class="nv">onPlaceLabel: </span><span class="nf">(domElement, node) -&gt;</span>
            <span class="nv">left = </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">domElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span>
            <span class="nv">top  = </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">domElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="p">)</span>
            <span class="nv">w    = </span><span class="nx">domElement</span><span class="p">.</span><span class="nx">offsetWidth</span>
            <span class="nv">domElement.style.left = </span><span class="p">(</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">w</span> <span class="err">/ 2) + &#39;px&#39;</span>
            <span class="nv">domElement.style.top  = </span><span class="p">(</span><span class="nx">top</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span>
            <span class="nv">domElement.style.display = </span><span class="s1">&#39;&#39;</span>
            <span class="k">return</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">fd</span><span class="p">.</span><span class="nx">loadJSON</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">fd</span><span class="p">.</span><span class="nx">computeIncremental</span>
        <span class="nv">iter: </span><span class="mi">40</span>
        <span class="nv">property: </span><span class="s1">&#39;end&#39;</span>
        <span class="nv">onStep: </span><span class="nf">(perc) -&gt;</span>
            <span class="nx">Log</span><span class="p">.</span><span class="nx">write</span> <span class="s2">&quot;#{perc}% loaded...&quot;</span>
            <span class="k">return</span>
        <span class="nv">onComplete: </span><span class="o">-&gt;</span>
            <span class="nx">fd</span><span class="p">.</span><span class="nx">animate</span>
                <span class="nv">modes: </span><span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">]</span>
                <span class="nv">transition: </span><span class="nx">$jit</span><span class="p">.</span><span class="nx">Trans</span><span class="p">.</span><span class="nx">linear</span>
                <span class="nv">duration: </span><span class="mi">500</span>
            <span class="nx">Log</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
            <span class="k">return</span>
    <span class="k">return</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 